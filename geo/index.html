<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>LoboGeo</title>
     <link rel="stylesheet" href="leaflet.css?v1.0" />
     <script src="leaflet-src.js?v1.0"></script>
     <style>
          body { margin:0 auto; padding:0; font-family: monospace; background-color: #eeeeee; }
          #flex { display: flex; flex-direction: column;}
          #map { height:80vh; }
          #text { flex:1 100%; text-align: center; font-size:1.0em; padding: 15px; }
     </style>
</head>
<body>
     <div id="flex">
          <div id="map"></div>
          <div id="text"></div>
     </div>
</body>
<script>
     // Update 02.06.2024 23:05 by LoboSSL
     let array = []
     let map = null
     let zoom = null
     let marker = null
     let circle = null
     let newMarker = null
     let options = {
          enableHighAccuracy: true,
          maximumAge: 0,
          timeout: 86400
     }

     function success(event){
          let latitude = event.coords.latitude
          let longitude = event.coords.longitude
          let accuracy = event.coords.accuracy

          let omg = L.latLng(latitude,longitude)
          array.push(omg)

          map.on('click', function(ev){
               newMarker = L.marker([ev.latlng.lat,ev.latlng.lng]).addTo(map)

               let a = L.latLng(latitude,longitude)
               let b = L.latLng(ev.latlng.lat,ev.latlng.lng)

               array.push(b)

               let distance = Number(map.distance(a,b)).toFixed(2)

               let km = 1000
               let mil = 10000

               if(distance >= mil){
                    distance = (distance / mil) + " (mil)"
               }
               else if(distance >= km && distance < mil){
                    distance = (distance / km) + " (km)"
               }
               else if(distance < km){
                    distance = (distance) + " (meter)"
               }

               document.getElementById("text").innerText = "Distance from you and marker:" + distance
          })

          if(marker){
               map.removeLayer(marker)
               map.removeLayer(circle)
          }

          marker = L.marker([latitude, longitude]).addTo(map)
          circle = L.circle([latitude, longitude],{ radius: accuracy }).addTo(map)

          if(!zoom){
               zoom = map.fitBounds(circle.getBounds())
          }

          L.polyline(array, {
               color: 'red'
          }).addTo(map)

          map.setView([latitude,longitude])
     }

     function error(event){
          if(event.code == 1){
               document.getElementById("text").innerText = event.message
          }
          else if(event.code == 2){
               document.getElementById("text").innerText = event.message
          }
          else if(event.code == 3){
               document.getElementById("text").innerText = event.message
          }
          else{
               document.getElementById("text").innerText = "ERROR"
          }
     }

     map = L.map('map').setView([0, 0],13)

     L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',{
               maxZoom: 19,
               attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
     }).addTo(map)

     window.onload = () =>
     {
          window.setInterval(() => {
               if(navigator.geolocation){
                    navigator.geolocation.getCurrentPosition(success, error, options)
               }
          },1000)
     }
</script>
</html>