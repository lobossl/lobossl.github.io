<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>LoboGeo</title>
     <link rel="stylesheet" href="leaflet.css?v1.0" />
     <script src="leaflet-src.js?v1.0"></script>
     <style>
          body { margin:0 auto; padding:0; font-family: monospace; background-color: #eeeeee; }
          #flex { display: flex; flex-direction: column;}
          #map { height:80vh; }
          #text { flex:1 100%; text-align: center; font-size:1.0em; padding: 15px; }
     </style>
</head>
<body>
     <div id="flex">
          <div id="map"></div>
          <div id="text"></div>
     </div>
</body>
<script>
     let map = null
     let zoom = null
     let marker = null
     let circle = null

     let options = {
          enableHighAccuracy: true,
          maximumAge: 0,
          timeout: 60000
     }

     map = L.map('map').setView([0, 0],13)

     L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',{
               maxZoom: 19,
               attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
     }).addTo(map)

     window.onload = () =>
     {
          window.setInterval(() => {
               if(navigator.geolocation){
                    navigator.geolocation.getCurrentPosition(success, error, options)
               }
          },1000)
     }

     function success(event){
          let latitude = event.coords.latitude
          let longitude = event.coords.longitude
          let accuracy = event.coords.accuracy

          document.getElementById("text").innerText = "latitude:" + latitude + "\nlongitude:" + longitude + "\naccuracy:" + accuracy

          if(marker){
               map.removeLayer(marker)
               map.removeLayer(circle)
          }

          marker = L.marker([latitude, longitude]).addTo(map)
          circle = L.circle([latitude, longitude],{ radius: accuracy }).addTo(map)

          if(!zoom){
               zoom = map.fitBounds(circle.getBounds())
          }

          map.setView([latitude,longitude])
     }

     function error(event){
          alert(event.message)
     }
</script>
</html>